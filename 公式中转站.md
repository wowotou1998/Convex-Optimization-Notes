

$$
\left\{\begin{array}{l}A x^{*}=b \\ \nabla f\left(x^{*}\right)+A^{T} v^{*}=0\end{array}\right. \\
$$
改写成一个罚函数的样子, 去当作一个新的优化问题来解: 
$$
\min P(x, v)=\frac{1}{2}\|A x-b\|_{2}^{2}+\frac{1}{2}\left\|\nabla f(x)+A^{T} v\right\|_{2}^{2} 
$$

特点: 这个新的无约束优化问题的解就是满足KKT条件的点。某种意义上说，相当于把原问题转化成了无约束优化问题, 我们可以去求这个新问题的目标函数的负梯度方向，然后梯度下降求最优解:

$$
-\nabla P\left(x^{k}, v^{k}\right)
=\left[\begin{array}{l}-\nabla_{x} P\left(x^{k}, v^{k}\right) -\nabla_{v} P\left(x^{k}, v^{k}\right)\end{array}\right]
\\
=-\left[\begin{array}{c}A^{T}\left(A x^{k}-b\right)+\nabla^{2} f\left(x^{k}\right)\left(\nabla f\left(x^{k}\right)+A^{T} v\right) \\ A\left(\nabla f\left(x^{k}\right)+A^{T} v^{k}\right)\end{array}\right] \\
$$

$$
\begin{aligned}
令 d^{k}
&=\nabla f\left(x^{k}\right)+A^{T} v^{k} \left(d^{k}\right)^{T}\left(-\nabla P\left(x^{k}, v^{k}\right)\right) \\
&=\left(\nabla f\left(x^{k}\right)+A^{T} v^{k}\right)^{T}\left[-\left(A^{T}\left(A x^{k}-b\right)+\nabla^{2} f\left(x^{k}\right)\right)\left(\nabla f\left(x^{k}\right)+A^{T} v\right)\right] \\
&=\left(\nabla f\left(x^{k}\right)+A^{T} v^{k}\right)^{T} A^{T}\left(A x^{k}-b\right) 
\left(\nabla f\left(x^{k}\right)+A^{T} v^{k}\right)^{T} \nabla^{2} f\left(x^{k}\right)\left(\nabla f\left(x^{k}\right)+A^{T} v^{k}\right) \\
&\qquad -\left(A^{T} x^{k}-b\right)^{T} A\left(\nabla f\left(x^{k}\right)+A^{T} v^{k}\right) \\
&=\left(\nabla f\left(x^{k}\right)+A^{T} v^{k}\right) \nabla^{2} f\left(x^{k}\right)\left(\nabla f\left(x^{k}\right)+A^{T} v^{k}\right)
\end{aligned}
$$

上边这个式子(二次型), 当 $\nabla^{2} f\left(x^{k}\right) \succ 0$ 且 $\left(\nabla f\left(x^{k}\right)+A^{T} v^{k}\right)$ 不全为 0 时, 会 大于等于 0 。即:$\left\{\begin{array}{l}\nabla f\left(x^{k}\right)+A^{T} v^{k} \neq 0 \\ \nabla^{2} f\left(x^{k}\right) \succ 0\end{array}\right.
$ 时, $d^{k}$ 是 $P\left(u^{k}, v^{k}\right)$ 的一个下降方向(和负梯度方向同向)
而上面这个条件是成立的。因为原问题凸, 所以Hessian矩阵半正定。而当随着迭代 $x^{k} \rightarrow x^{*}$ 的时候, $\nabla^{2} f\left(x^{*}\right)=0$, 那么大部分情况下 $\nabla^{2} f\left(x^{k}\right)$ 都是正定的。另外, 只要 $v^{k}, x^{k}$ 还没有到达最优解, $\nabla f\left(x^{k}\right)+A^{T} v^{k} \neq 0$ 就一直满足, 当 $v^{*} \rightarrow v^{*}, x^{k} \rightarrow x^{*}$ 时, $\nabla f\left(x^{k}\right)+A^{T} v^{k}=0$, 此时 $x^{k+1}=x^{k}, v^{k+1}=v^{k}$,
算法也就停止更新了。 (对拉格朗日法进行理论分析很有意义, 但是这个算法实际运行起来速度很慢, 所以为了提
高一下效率, 诞生了下一节的增广拉格朗日法。